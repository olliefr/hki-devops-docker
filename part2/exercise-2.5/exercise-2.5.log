material-applications/scaling-exercise on  main [!] on ☁️ (europe-north1)
❯ docker-compose up --build -d calculator load-balancer
Creating network "scaling-exercise_default" with the default driver
Building load-balancer
[+] Building 4.1s (6/6) FINISHED
 => [internal] load build definition from Dockerfile                                                               0.1s
 => => transferring dockerfile: 37B                                                                                0.0s
 => [internal] load .dockerignore                                                                                  0.2s
 => => transferring context: 2B                                                                                    0.0s
 => [internal] load metadata for docker.io/jwilder/nginx-proxy:latest                                              3.7s
 => [auth] jwilder/nginx-proxy:pull token for registry-1.docker.io                                                 0.0s
 => CACHED [1/1] FROM docker.io/jwilder/nginx-proxy@sha256:55398feecbc2f3582ee2a175e3e3d430e31735110474b348b417c6  0.0s
 => exporting to image                                                                                             0.2s
 => => exporting layers                                                                                            0.0s
 => => writing image sha256:c4bb40a6349760d5f0681b9ade23b6b3cff5951dbdd4152cf9376740440447c2                       0.0s
 => => naming to docker.io/library/load-balancer                                                                   0.0s

Use 'docker scan' to run Snyk tests against images to find vulnerabilities and learn how to fix them
Successfully built c4bb40a6349760d5f0681b9ade23b6b3cff5951dbdd4152cf9376740440447c2
Use 'docker scan' to run Snyk tests against images to find vulnerabilities and learn how to fix them
Creating calculator    ... done
Creating load-balancer ... done

material-applications/scaling-exercise on  main [!] on ☁️ (europe-north1) took 6s
❯ docker-compose up --scale compute=10
calculator is up-to-date
load-balancer is up-to-date
Creating scaling-exercise_compute_1  ... done
Creating scaling-exercise_compute_2  ... done
Creating scaling-exercise_compute_3  ... done
Creating scaling-exercise_compute_4  ... done
Creating scaling-exercise_compute_5  ... done
Creating scaling-exercise_compute_6  ... done
Creating scaling-exercise_compute_7  ... done
Creating scaling-exercise_compute_8  ... done
Creating scaling-exercise_compute_9  ... done
Creating scaling-exercise_compute_10 ... done
Attaching to calculator, load-balancer, scaling-exercise_compute_1, scaling-exercise_compute_10, scaling-exercise_compute_3, scaling-exercise_compute_6, scaling-exercise_compute_5, scaling-exercise_compute_9, scaling-exercise_compute_8, scaling-exercise_compute_2, scaling-exercise_compute_7, scaling-exercise_compute_4
compute_1        | I am alive in port 3000!
compute_10       | I am alive in port 3000!
compute_2        | I am alive in port 3000!
compute_3        | I am alive in port 3000!
compute_5        | I am alive in port 3000!
compute_6        | I am alive in port 3000!
compute_7        | I am alive in port 3000!
compute_8        | I am alive in port 3000!
compute_9        | I am alive in port 3000!
load-balancer    | WARNING: /etc/nginx/dhparam/dhparam.pem was not found. A pre-generated dhparam.pem will be used for now while a new one
load-balancer    | is being generated in the background.  Once the new dhparam.pem is in place, nginx will be reloaded.
load-balancer    | forego     | starting dockergen.1 on port 5000
load-balancer    | forego     | starting nginx.1 on port 5100
load-balancer    | dockergen.1 | 2021/05/05 17:35:44 Generated '/etc/nginx/conf.d/default.conf' from 2 containers
load-balancer    | dockergen.1 | 2021/05/05 17:35:44 Watching docker events
load-balancer    | dockergen.1 | 2021/05/05 17:35:44 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'
load-balancer    | 2021/05/05 17:35:47 [notice] 52#52: signal process started
load-balancer    | Generating DSA parameters, 4096 bit long prime
load-balancer    | dhparam generation complete, reloading nginx
load-balancer    | dockergen.1 | 2021/05/05 17:35:50 Received event start for container b7b5008d9a51
load-balancer    | dockergen.1 | 2021/05/05 17:35:53 Received event start for container 56745eea254b
load-balancer    | dockergen.1 | 2021/05/05 17:35:53 Received event start for container b0ff73d60a01
load-balancer    | dockergen.1 | 2021/05/05 17:35:53 Received event start for container 9a1e56e4adcf
load-balancer    | dockergen.1 | 2021/05/05 17:35:53 Received event start for container 798a2d23699f
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Received event start for container f1889ccc087c
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Received event start for container 8f74e7947931
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Received event start for container 79f4d86d5c68
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Received event start for container b07a491791fa
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Received event start for container 80699c27db5d
calculator       |
calculator       | > calc@1.0.0 start /usr/app
calculator       | > serve -s -l 3000 dist
calculator       |
calculator       | UPDATE AVAILABLE The latest version of `serve` is 11.3.2
calculator       | INFO: Accepting connections at http://localhost:3000
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Generated '/etc/nginx/conf.d/default.conf' from 12 containers
compute_4        | I am alive in port 3000!
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'
load-balancer    | dockergen.1 | 2021/05/05 17:35:54 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'
load-balancer    | dockergen.1 | 2021/05/05 17:35:55 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'
load-balancer    | dockergen.1 | 2021/05/05 17:35:55 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'
load-balancer    | dockergen.1 | 2021/05/05 17:35:55 Contents of /etc/nginx/conf.d/default.conf did not change. Skipping notification 'nginx -s reload'
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:02 +0000] "OPTIONS / HTTP/1.1" 204 0 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:02 +0000] "OPTIONS / HTTP/1.1" 204 0 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:02 +0000] "OPTIONS / HTTP/1.1" 204 0 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:02 +0000] "OPTIONS / HTTP/1.1" 204 0 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:02 +0000] "OPTIONS / HTTP/1.1" 204 0 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:02 +0000] "OPTIONS / HTTP/1.1" 204 0 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
compute_4        | Added to que
compute_4        | Started resolving loop
compute_4        | Started calculations for 1 + 1
compute_5        | Added to que
compute_5        | Started resolving loop
compute_4        | Added to que
compute_5        | Started calculations for 3 + 3
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:02 +0000] "OPTIONS / HTTP/1.1" 204 0 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
compute_5        | Added to que
compute_2        | Added to que
compute_2        | Started resolving loop
compute_2        | Started calculations for 4 + 4
compute_2        | Added to que
compute_4        | Calculated 1 + 1: 2
compute_4        | Started calculations for 2 + 2
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:05 +0000] "POST / HTTP/1.1" 200 39 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
compute_10       | Added to que
compute_10       | Started resolving loop
compute_10       | Started calculations for 7 + 7
compute_2        | Calculated 4 + 4: 8
compute_2        | Started calculations for 6 + 6
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:05 +0000] "POST / HTTP/1.1" 200 39 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
compute_10       | Added to que
compute_5        | Calculated 3 + 3: 6
compute_5        | Started calculations for 5 + 5
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:05 +0000] "POST / HTTP/1.1" 200 39 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
compute_1        | Added to que
compute_1        | Started resolving loop
compute_1        | Started calculations for 10 + 10
compute_10       | Calculated 7 + 7: 14
compute_10       | Started calculations for 9 + 9
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:08 +0000] "POST / HTTP/1.1" 200 40 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
compute_1        | Added to que
compute_4        | Calculated 2 + 2: 4
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:09 +0000] "POST / HTTP/1.1" 200 39 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
compute_1        | Calculated 10 + 10: 20
compute_1        | Started calculations for 8 + 8
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:09 +0000] "POST / HTTP/1.1" 200 42 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
compute_2        | Calculated 6 + 6: 12
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:09 +0000] "POST / HTTP/1.1" 200 40 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
compute_5        | Calculated 5 + 5: 10
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:09 +0000] "POST / HTTP/1.1" 200 40 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
compute_10       | Calculated 9 + 9: 18
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:11 +0000] "POST / HTTP/1.1" 200 40 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
compute_1        | Calculated 8 + 8: 16
load-balancer    | nginx.1    | compute.localtest.me 172.20.0.1 - - [05/May/2021:17:36:13 +0000] "POST / HTTP/1.1" 200 40 "http://localhost:3000/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Edg/90.0.818.51"
^CGracefully stopping... (press Ctrl+C again to force)
Stopping scaling-exercise_compute_9  ... done
Stopping scaling-exercise_compute_3  ... done
Stopping scaling-exercise_compute_8  ... done
Stopping scaling-exercise_compute_7  ... done
Stopping scaling-exercise_compute_6  ... done
Stopping scaling-exercise_compute_4  ... done
Stopping scaling-exercise_compute_5  ... done
Stopping scaling-exercise_compute_2  ... done
Stopping scaling-exercise_compute_10 ... done
Stopping scaling-exercise_compute_1  ... done
Stopping load-balancer               ... done
Stopping calculator                  ... done

material-applications/scaling-exercise on  main [!] on ☁️ (europe-north1) took 41s
❯ docker-compose down
Removing scaling-exercise_compute_9  ... done
Removing scaling-exercise_compute_3  ... done
Removing scaling-exercise_compute_8  ... done
Removing scaling-exercise_compute_7  ... done
Removing scaling-exercise_compute_6  ... done
Removing scaling-exercise_compute_4  ... done
Removing scaling-exercise_compute_5  ... done
Removing scaling-exercise_compute_2  ... done
Removing scaling-exercise_compute_10 ... done
Removing scaling-exercise_compute_1  ... done
Removing load-balancer               ... done
Removing calculator                  ... done
Removing network scaling-exercise_default

material-applications/scaling-exercise on  main [!] on ☁️ (europe-north1)
